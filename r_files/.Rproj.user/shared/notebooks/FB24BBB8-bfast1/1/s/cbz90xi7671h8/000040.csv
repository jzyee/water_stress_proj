"0","library('bfast')"
"0","library('fossil')"
"0",""
"0","set.seed(1)"
"0",""
"0","bp_df = NA"
"0",""
"0","df_names = matrix()"
"0",""
"0","for(col in names(signal_df))"
"0","{"
"0","    if (col != 'Date'){ "
"0","            #print(signal_df[col])"
"0","            if(is.na(df_names)){"
"0","                df_names <- col"
"0","            }"
"0","            else{"
"0","                df_names <-  c(df_names, col)"
"0","            }"
"0","            print(col)"
"0","        }"
"0","   "
"0","}"
"1","[1]"
"1"," ""X0"""
"1","
"
"1","[1]"
"1"," ""X1"""
"1","
"
"2","the condition has length > 1 and only the first element will be used"
"1","[1]"
"1"," ""X2"""
"1","
"
"2","the condition has length > 1 and only the first element will be used"
"1","[1]"
"1"," ""X3"""
"1","
"
"2","the condition has length > 1 and only the first element will be used"
"1","[1]"
"1"," ""X4"""
"1","
"
"0","df_names"
"1","[1]"
"1"," ""X0"""
"1"," ""X1"""
"1"," ""X2"""
"1"," ""X3"""
"1"," ""X4"""
"1","
"
"0","# h_factors parms"
"0","h_list = c(0.01, 0.1, 0.2, 0.4, 0.5)"
"0",""
"0","for (h in h_list){"
"0","    for (idx in 1: length(df_names)){"
"0","        h_ts <- ts(as.numeric(signal_df[[df_names[idx]]]), frequency = 12, start = 1986)"
"0","        fit <- bfast(h_ts, h=h, season='harmonic', max.iter = 20)"
"0","        #plot(fit)"
"0","        "
"0","        ## handlign fit output"
"0","        niter <- length(fit$output) # nr of iterations"
"0","        out <- fit$output[[niter]]"
"0","        "
"0","        #intializing row values"
"0","        pred_bp <- NA"
"0","        hausdorff_score <- NA"
"0","        randindex_score <- NA"
"0","        "
"0","        # output of results of the final fitted seasonal and trend models and"
"0","        ## #nr of breakpoints in both."
"0","        if ('breakpoints' %in% names(out$bp.Vt)){"
"0","            pred_bp <- out$bp.Vt$breakpoints"
"0","        "
"0","        "
"0","            ts_breakpoints <- matrix(201, 301)"
"0","        "
"0","            if (is.na(pred_bp[1]) == FALSE){"
"0","                hausdorff_score <- hausdorff_dist(out$bp.Vt$breakpoints, ts_breakpoints)"
"0","                #randindex_score <- rand.index(as.numeric(out$bp.Vt$breakpoints), as.numeric(ts_breakpoints))"
"0","            }"
"0","        }"
"0","        "
"0","        bp_row = data.frame('pred_bp' = pred_bp, "
"0","                            #'hausdorff_score' = hausdorff_score,"
"0","                            #'randIndex' = randindex_score,"
"0","                            'signal_no' = idx ,'col_name' = df_names[idx],"
"0","                            'h_factor' = h)"
"0","        "
"0","        if (is.na(bp_df)){"
"0","            bp_df <- bp_row"
"0","        }"
"0","        else{"
"0","            bp_df <- rbind(bp_df, bp_row)"
"0","        }"
"0","    }"
"0","}"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"2","the condition has length > 1 and only the first element will be used"
"0","bp_df"
